unit UnitAddShortcut;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, System.StrUtils;

type
  TFormAddShortcut = class(TForm)
    Label1: TLabel;
    lbNomeEdit: TLabel;
    edtParam: TEdit;
    edtNome: TEdit;
    btnBrowse: TButton;
    btnOK: TButton;
    btnCancel: TButton;
    OpenDialog: TOpenDialog;
    procedure btnBrowseClick(Sender: TObject);
    procedure btnOKClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

  function CadastroMenu(var nome,param:String;tipo:String='e'):Boolean;

implementation

{$R *.dfm}

var
  esubmenu:Boolean;

function CadastroMenu(var nome,param:String;tipo:String='e'):Boolean;
begin
  result := false;
  if param = 'submenu' then
    esubmenu := true;

  var FormAdd := TFormAddShortcut.Create(nil);
  try
    FormAdd.Caption           := IfThen(tipo = 'e','Editar Atalho','Adicionar Atalho');
    if esubmenu then
      FormAdd.lbNomeEdit.caption := 'Sub-menu';
    FormAdd.btnBrowse.Enabled := not esubmenu;

    FormAdd.edtNome.Text      := nome;
    FormAdd.edtParam.Enabled  := not esubmenu;
    if not esubmenu then
      FormAdd.edtParam.Text   := param;

    if FormAdd.ShowModal = mrOk then
    begin
      result := true;
      nome   := Trim(FormAdd.edtNome.Text);
      param  := Trim(FormAdd.edtParam.Text);
    end;
  finally
    FormAdd.Free;
  end;
end;

procedure TFormAddShortcut.btnBrowseClick(Sender: TObject);
begin
  if OpenDialog.Execute then
  begin
    edtNome.Text := OpenDialog.FileName;
  end;
end;


procedure TFormAddShortcut.btnOKClick(Sender: TObject);
begin
  if Trim(edtNome.Text) = ''  then begin
    ShowMessage('Não informado');
    exit;
  end;

  if (not esubmenu) and (not FileExists( edtNome.Text )) then begin
    ShowMessage('Executavel não existe');
    exit;
  end;

  ModalResult := mrOk;
end;

end.